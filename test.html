<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Test</title>

<style>
body { font-family: Arial; padding: 15px; }
.option {
  display: block;
  margin: 8px 0;
  padding: 10px;
  border: 1px solid #aaa;
  cursor: pointer;
}
.option:hover { background: #f0f0f0; }
.selected { background: #d0ebff; }
.green { color: green; }
.red { color: red; }
button { margin: 5px; padding: 8px 12px; }
</style>
</head>

<body>

<h2>Test</h2>
<div id="timer">00:00</div>

<hr>

<div id="question"></div>
<div id="options"></div>

<hr>

<button onclick="prevQuestion()">Back</button>
<button onclick="skipQuestion()">Skip</button>
<button onclick="submitTest()">Submit</button>

<script>
/* ================= SAMPLE QUESTIONS ================= */
const questions = [
  {
    q: "राजस्थान की राजधानी क्या है?",
    options: ["जयपुर", "जोधपुर", "कोटा", "बीकानेर"],
    answer: 0,
    explanation: "राजस्थान की राजधानी जयपुर है।"
  },
  {
    q: "थार मरुस्थल किस राज्य में है?",
    options: ["गुजरात", "राजस्थान", "हरियाणा", "पंजाब"],
    answer: 1,
    explanation: "थार मरुस्थल मुख्यतः राजस्थान में है।"
  }
];

/* ================= VARIABLES ================= */
let currentIndex = 0;
let userAnswers = [];
let score = 0;
let timer = 0;
let interval;
let autoNextTimeout;
const NEGATIVE = 1/3;

/* ================= TIMER ================= */
function startTimer() {
  interval = setInterval(() => {
    timer++;
    document.getElementById("timer").innerText =
      new Date(timer * 1000).toISOString().substr(14, 5);
  }, 1000);
}

/* ================= DISPLAY QUESTION ================= */
function displayQuestion() {
  clearTimeout(autoNextTimeout);

  const q = questions[currentIndex];
  document.getElementById("question").innerHTML =
    `<b>Q${currentIndex + 1}.</b> ${q.q}`;

  const optDiv = document.getElementById("options");
  optDiv.innerHTML = "";

  q.options.forEach((opt, index) => {
    const btn = document.createElement("div");
    btn.className = "option";
    btn.innerText = opt;

    if (userAnswers[currentIndex]?.selected === index) {
      btn.classList.add("selected");
    }

    btn.onclick = () => selectOption(index);
    optDiv.appendChild(btn);
  });
}

/* ================= SELECT OPTION ================= */
function selectOption(index) {
  userAnswers[currentIndex] = { selected: index, skipped: false };

  autoNextTimeout = setTimeout(() => {
    if (currentIndex < questions.length - 1) {
      currentIndex++;
      displayQuestion();
    }
  }, 3000);
}

/* ================= BACK ================= */
function prevQuestion() {
  if (currentIndex > 0) {
    currentIndex--;
    displayQuestion();
  }
}

/* ================= SKIP ================= */
function skipQuestion() {
  userAnswers[currentIndex] = { selected: null, skipped: true };
  if (currentIndex < questions.length - 1) {
    currentIndex++;
    displayQuestion();
  }
}

/* ================= SUBMIT ================= */
function submitTest() {
  clearInterval(interval);
  clearTimeout(autoNextTimeout);
  score = 0;

  questions.forEach((q, i) => {
    const ua = userAnswers[i];
    if (!ua || ua.skipped) return;
    if (ua.selected === q.answer) score += 1;
    else score -= NEGATIVE;
  });

  showResult();
}

/* ================= RESULT ================= */
function showResult() {
  let html = `<h2>Result</h2>`;
  html += `<p>Score: <b>${score.toFixed(2)}</b></p><hr>`;

  questions.forEach((q, i) => {
    const ua = userAnswers[i];
    html += `<p><b>Q${i + 1}:</b> ${q.q}</p>`;

    q.options.forEach((opt, idx) => {
      let cls = "";
      if (idx === q.answer) cls = "green";
      if (ua && idx === ua.selected && ua.selected !== q.answer) cls = "red";
      html += `<div class="${cls}">${opt}</div>`;
    });

    html += `<i>Explanation:</i> ${q.explanation}<hr>`;
  });

  document.body.innerHTML = html;
}

/* ================= START ================= */
startTimer();
displayQuestion();
</script>

</body>
</html>
