<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Profile</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
  body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #f4f6f8; }

  header { background: #1e88e5; color: white; padding: 15px; display: flex; align-items: center; gap: 15px; }
  .back-btn { font-size: 24px; cursor: pointer; color: white; border: none; background: none; }
  .title { font-size: 20px; font-weight: bold; }

  .profile-container { padding: 30px 20px; text-align: center; }
  
  .profile-card {
    background: white; padding: 30px; border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 400px; margin: 0 auto;
  }
  
  .user-img {
    width: 100px; height: 100px; border-radius: 50%; object-fit: cover;
    border: 4px solid #1e88e5; margin-bottom: 15px;
  }
  
  .user-name { font-size: 22px; font-weight: bold; color: #333; margin-bottom: 5px; }
  .user-email { font-size: 14px; color: #666; margin-bottom: 20px; }
  
  .badge {
    background: #e3f2fd; color: #1565c0; padding: 8px 15px;
    border-radius: 20px; font-size: 14px; font-weight: bold; display: inline-block;
  }
  
  .premium-badge {
    background: #fff8e1; color: #fbc02d; border: 1px solid #fbc02d;
  }
</style>
</head>
<body>

<header>
  <button class="back-btn" onclick="window.history.back()">&#8592;</button>
  <div class="title">My Profile</div>
</header>

<div class="profile-container">
  <div class="profile-card">
    <img id="p-img" src="https://via.placeholder.com/100?text=User" class="user-img">
    
    <div id="p-name" class="user-name">Loading Name...</div>
    <div id="p-email" class="user-email">Loading Email...</div>
    
    <div id="p-status" class="badge">Free User</div>
  </div>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBCuefZt2WuNsNiFme8M-HUHm_BZYKJAi4",
    authDomain: "career-care-afb64.firebaseapp.com",
    databaseURL: "https://career-care-afb64-default-rtdb.firebaseio.com",
    projectId: "career-care-afb64",
    appId: "1:267890746286:web:2c38f0980119d01b145e3f"
  };
  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);

  // 1. Pehle Local Storage se Data uthao (Fast Display ke liye)
  const localName = localStorage.getItem("userName");
  const localPic = localStorage.getItem("userPhoto");
  const localEmail = localStorage.getItem("userEmail");
  const isPremium = localStorage.getItem("isPremium");

  if(localName) document.getElementById("p-name").innerText = localName;
  if(localEmail) document.getElementById("p-email").innerText = localEmail;
  if(localPic) document.getElementById("p-img").src = localPic;
  
  if(isPremium === "true") {
      const badge = document.getElementById("p-status");
      badge.innerText = "⭐ Premium Member";
      badge.classList.add("premium-badge");
  }

  // 2. Firebase se Confirm karo (Agar update hua ho)
  firebase.auth().onAuthStateChanged((user) => {
    if (user) {
        // Data Update
        document.getElementById("p-name").innerText = user.displayName;
        document.getElementById("p-email").innerText = user.email;
        if(user.photoURL) document.getElementById("p-img").src = user.photoURL;

        // Check Premium from Database
        firebase.database().ref("students/" + user.uid).once("value").then(snap => {
            if(snap.exists()){
                const data = snap.val();
                if(data.isPremium){
                   const badge = document.getElementById("p-status");
                   badge.innerText = "⭐ Premium Member";
                   badge.classList.add("premium-badge");
                }
            }
        });
    } else {
        // Agar login nahi hai, to login page bhejo
        window.location.href = "login.html";
    }
  });
</script>

</body>
</html>
  
