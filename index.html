<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Career Care</title>
    <style>
        body { display: flex; justify-content: center; align-items: center; height: 100vh; background: #f0f2f5; font-family: sans-serif; flex-direction: column; }
        .login-card { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; width: 300px; }
        .btn-google { background: #db4437; color: white; padding: 12px; width: 100%; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin-top: 20px; }
        h2 { margin-bottom: 5px; color: #333; }
        p { color: #666; font-size: 14px; }
    </style>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
</head>
<body>

    <div class="login-card">
        <h2>Welcome Back</h2>
        <p>Login to continue your prep</p>
        
        <button class="btn-google" type="button" onclick="handleLogin()">
            Sign in with Google
        </button>
        
        <p id="status" style="margin-top:20px; color:blue; font-size:12px;">Waiting for action...</p>
    </div>

<script>
    // 1. CONFIGURATION
    const firebaseConfig = {
      apiKey: "AIzaSyBCuefZt2WuNsNiFme8M-HUHm_BZYKJAi4",
      authDomain: "career-care-afb64.firebaseapp.com",
      projectId: "career-care-afb64",
      appId: "1:267890746286:web:2c38f0980119d01b145e3f"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);

    const statusText = document.getElementById("status");

    // 2. CHECK IF ALREADY LOGGED IN (Auto-Redirect)
    firebase.auth().onAuthStateChanged((user) => {
        if (user) {
            statusText.innerText = "User already found: " + user.email;
            // Thoda ruk kar redirect karte hain taaki aap message padh sakein
            setTimeout(() => {
                goToApp();
            }, 1000);
        } else {
            statusText.innerText = "No user logged in. Please click button.";
        }
    });

    // 3. LOGIN FUNCTION
    function handleLogin() {
        statusText.innerText = "Opening Google Popup...";
        
        var provider = new firebase.auth.GoogleAuthProvider();
        
        firebase.auth().signInWithPopup(provider)
        .then((result) => {
            // Success
            statusText.innerText = "Login Success! Redirecting...";
            alert("✅ Login Successful!\nEmail: " + result.user.email + "\nAb hum Current Affairs page par ja rahe hain.");
            
            // Redirect Function Call
            goToApp();
        })
        .catch((error) => {
            // Error Handling
            console.error(error);
            statusText.innerText = "Error: " + error.message;
            alert("❌ ERROR AAYA HAI:\n" + error.message);
        });
    }

    // 4. REDIRECT FUNCTION
    function goToApp() {
        // Yahan check karein ki aapki file ka naam 'current_affairs.html' hi hai na?
        // Agar file kisi folder mein hai to path check karein.
        window.location.href = "current_affairs.html";
    }

</script>

</body>
</html>
