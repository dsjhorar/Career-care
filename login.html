<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Login Check</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
  body { font-family: sans-serif; background: #eee; display: flex; height: 100vh; justify-content: center; align-items: center; text-align: center; }
  .card { background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 350px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
  button { padding: 12px 20px; font-size: 16px; cursor: pointer; background: #1e88e5; color: white; border: none; border-radius: 5px; margin-top: 10px; width: 100%; }
  .success-box { background: #e8f5e9; color: #2e7d32; padding: 15px; border-radius: 5px; margin-top: 15px; display: none; }
  #user-details { font-weight: bold; margin-bottom: 10px; display: block; }
</style>
</head>
<body>

<div class="card">
  <h2>Career Care Login</h2>
  
  <div id="login-section">
      <p>Click below to sign in:</p>
      <button onclick="startLogin()">ðŸ”µ Sign in with Google</button>
  </div>

  <div id="success-section" class="success-box">
      <h3>âœ… Login Successful!</h3>
      <span id="user-details"></span>
      <button style="background: green;" onclick="goToDashboard()">ðŸš€ Go to Dashboard</button>
  </div>

  <p id="status" style="margin-top:20px; color:#555; font-size:12px;">Waiting for action...</p>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBCuefZt2WuNsNiFme8M-HUHm_BZYKJAi4",
    authDomain: "career-care-afb64.firebaseapp.com",
    databaseURL: "https://career-care-afb64-default-rtdb.firebaseio.com",
    projectId: "career-care-afb64",
    appId: "1:267890746286:web:2c38f0980119d01b145e3f"
  };
  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);

  const statusTxt = document.getElementById("status");
  const loginSec = document.getElementById("login-section");
  const successSec = document.getElementById("success-section");

  // 1. Check agar banda pehle se login hai
  firebase.auth().onAuthStateChanged((user) => {
    if (user) {
        showSuccess(user);
    } else {
        statusTxt.innerText = "Please log in.";
    }
  });

  function startLogin() {
    statusTxt.innerText = "Opening Google Popup...";
    var provider = new firebase.auth.GoogleAuthProvider();
    
    // Popup use kar rahe hain taaki result yahin dikhe
    firebase.auth().signInWithPopup(provider)
    .then((result) => {
        statusTxt.innerText = "Google Auth Complete.";
        // onAuthStateChanged will handle the rest
    })
    .catch((error) => {
        alert("Error: " + error.message);
        statusTxt.innerText = "Error: " + error.message;
    });
  }

  function showSuccess(user) {
    loginSec.style.display = "none";
    successSec.style.display = "block";
    
    document.getElementById("user-details").innerText = "Welcome, " + user.displayName;
    statusTxt.innerText = "You are logged in.";
    
    // Save Local Data
    localStorage.setItem("userUid", user.uid);
  }

  function goToDashboard() {
    // Ab user button dabakar jayega, to loop nahi banega
    window.location.href = "index.html";
  }
</script>

</body>
</html>
